{"version":3,"sources":["validation/validationRenderer.js"],"names":["MaterializeFormValidationRenderer","className","classNameFirst","render","instruction","allElements","Array","unrender","result","elements","element","remove","indexOf","push","add","forEach","underlineInput","e","input","tagName","querySelector","selectWrapper","closest","querySelectorAll","length","classList","valid","label","removeAttribute","target","hasAttribute","addMessage","getAttribute","parentNode","removeMessage","$","parentElement","children","hasClass","message","document","createElement","id","textContent","style","opacity","appendChild","nextSibling","window","getComputedStyle","removeChild"],"mappings":"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","file":"../../../validation/validationRenderer.js","sourcesContent":["export class MaterializeFormValidationRenderer {\n\n  className = 'md-input-validation';\n  classNameFirst = 'md-input-validation-first';\n\n  render(instruction) {\n    let allElements = new Array();\n    for (let { result, elements } of instruction.unrender) {\n      for (let element of elements) {\n        this.remove(element, result);\n        if (allElements.indexOf(element) == -1) {\n          allElements.push(element);\n        }\n      }\n    }\n    for (let { result, elements } of instruction.render) {\n      for (let element of elements) {\n        this.add(element, result);\n        if (allElements.indexOf(element) == -1) {\n          allElements.push(element);\n        }\n      }\n    }\n    allElements.forEach(e => this.underlineInput(e));\n  }\n\n  underlineInput(element) {\n    let input;\n    switch (element.tagName) {\n      case 'MD-INPUT': {\n        input = element.querySelector('input') || element.querySelector('textarea');\n        break;\n      }\n      case 'SELECT': {\n        const selectWrapper = element.closest('.select-wrapper');\n        if (selectWrapper) {\n          input = selectWrapper.querySelector('input');\n        }\n        break;\n      }\n      case 'INPUT': {\n        input = element;\n        break;\n      }\n      default: break;\n    }\n    if (input) {\n      if (element.querySelectorAll('.' + this.className).length === 0) {\n        input.classList.remove('invalid');\n        input.classList.add('valid');\n      }\n      else {\n        input.classList.remove('valid');\n        input.classList.add('invalid');\n      }\n    }\n  }\n\n  add(element, result) {\n    if (result.valid) {\n      return;\n    }\n    switch (element.tagName) {\n    case 'MD-INPUT': {\n      let label = element.querySelector('label');\n      let input = element.querySelector('input') || element.querySelector('textarea');\n      if (label) {\n        label.removeAttribute('data-error');\n      }\n      if (input) {\n        result.target = input;\n        if (input.hasAttribute('data-show-errortext')) {\n          this.addMessage(element, result);\n        }\n      }\n      break;\n    }\n    case 'SELECT': {\n      const selectWrapper = element.closest('.select-wrapper');\n      if (!selectWrapper) {\n        return;\n      }\n      let input = selectWrapper.querySelector('input');\n      if (input) {\n        result.target = input;\n        if (!(input.hasAttribute('data-show-errortext') &&\n            input.getAttribute('data-show-errortext') === 'false')) {\n          this.addMessage(selectWrapper, result);\n        }\n      }\n      break;\n    }\n    case 'INPUT' : {\n      if (element.hasAttribute('md-datepicker')) {\n        if (!(element.hasAttribute('data-show-errortext') &&\n            element.getAttribute('data-show-errortext') === 'false')) {\n          this.addMessage(element.parentNode, result);\n        }\n      }\n      break;\n    }\n    default: break;\n    }\n  }\n\n  remove(element, result) {\n    if (result.valid) {\n      return;\n    }\n    switch (element.tagName) {\n    case 'MD-INPUT': {\n      this.removeMessage(element, result);\n      break;\n    }\n    case 'SELECT': {\n      const selectWrapper = element.closest('.select-wrapper');\n      if (!selectWrapper) {\n        return;\n      }\n\n      if ($(selectWrapper.parentElement).children().hasClass('md-input-validation') ) {\n        this.removeMessage(selectWrapper.parentElement, result);\n      } else {\n        this.removeMessage(selectWrapper, result);\n      }\n      break;\n    }\n    case 'INPUT' : {\n      if (element.hasAttribute('md-datepicker')) {\n        this.removeMessage(element.parentNode, result);\n      }\n      break;\n    }\n    default: break;\n    }\n  }\n\n  addMessage(element, result) {\n    let message = document.createElement('div');\n    message.id = `md-input-validation-${result.id}`;\n    message.textContent = result.message;\n    message.className = this.className;\n    if (element.querySelectorAll('.' + this.className).length === 0) {\n      message.className += ' ' + this.classNameFirst;\n    }\n    message.style.opacity = 0;\n    element.appendChild(message, element.nextSibling);\n    window.getComputedStyle(message).opacity;\n    message.style.opacity = 1;\n  }\n\n  removeMessage(element, result) {\n    let message = element.querySelector(`#md-input-validation-${result.id}`);\n    if (message) {\n      element.removeChild(message);\n    }\n  }\n\n}\n"]}